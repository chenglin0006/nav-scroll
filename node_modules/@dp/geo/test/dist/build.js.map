{"version":3,"sources":["webpack:///webpack/bootstrap 5dd5e97c5f19348215ae","webpack:///./test/src/app.js","webpack:///./~/babel-runtime/core-js/json/stringify.js","webpack:///./~/core-js/library/fn/json/stringify.js","webpack:///./~/core-js/library/modules/_core.js","webpack:///./index.js","webpack:///./~/@dp/whereami/index.js","webpack:///./~/@dp/whereami/lib/config.js","webpack:///./~/@dp/whereami/lib/geos/cache.js","webpack:///./~/@dp/whereami/lib/cookie.js","webpack:///./~/@dp/whereami/lib/request.js","webpack:///./~/@dp/whereami/lib/log.js","webpack:///./~/@dp/whereami/lib/geos/url.js","webpack:///./~/@dp/whereami/lib/geos/tecent.js","webpack:///./~/@dp/whereami/lib/util.js","webpack:///./~/@dp/whereami/lib/geos/weixin.js","webpack:///./~/@dp/whereami/lib/geos/qqbrowser.js","webpack:///./~/@dp/whereami/lib/geos/mobileqq.js","webpack:///./~/@dp/whereami/lib/geos/app.js","webpack:///./~/@dp/whereami/lib/geos/meituanapp.js","webpack:///./~/@dp/whereami/lib/geos/html.js","webpack:///./~/@dp/util-m-ua/index.js","webpack:///./~/fetch-jsonp/build/fetch-jsonp.js","webpack:///./~/@dp/url-rewrite/dist/index.js"],"names":["config","alert","Whereami","require","ua","fetchJsonp","Ur","middleIp","cache","cbQueue","push","cb","self","fetch","_cb","action","getCityIdByIp","data","lock","shift","then","response","json","e","res","code","cityId","_action","city","lng","lat","cityid","timer","type","setTimeout","module","exports","env","options","source","timeout","cityType","wxAutoConfig","useTecentGeo","KNB","ready","_lockGetCity","_timerGetCity","getCity","success","clearTimeout","fail","dpapp"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;ACzFA;;;;;;AAGA,sBAAI,UAACA,MAAD,EAAU;AACbC,QAAM,yBAAeD,MAAf,CAAN;AACA,EAFD;AAGA,sBAAI,UAACA,MAAD,EAAU;AACbC,QAAM,OAAK,yBAAeD,MAAf,CAAX;AACA,EAFD,E;;;;;;ACNA,mBAAkB,uD;;;;;;ACAlB;AACA,wCAAuC,0BAA0B;AACjE,yCAAwC;AACxC;AACA,G;;;;;;ACJA,8BAA6B;AAC7B,sCAAqC,gC;;;;;;;;ACDrC,KAAIE,WAAW,mBAAAC,CAAQ,CAAR,CAAf;AACA,KAAIC,KAAK,mBAAAD,CAAQ,EAAR,GAAT;AACA,KAAIE,aAAa,mBAAAF,CAAQ,EAAR,CAAjB;AACA,KAAIG,KAAK,mBAAAH,CAAQ,EAAR,CAAT;;AAGA,KAAII,WAAW;AACdC,SAAM,KADQ;AAEdC,WAAQ,EAFM;AAGdC,QAAK,cAASC,EAAT,EAAY;AAChB,OAAIC,OAAO,IAAX;AACAA,QAAKH,OAAL,CAAaC,IAAb,CAAkBC,EAAlB;AACAC,QAAKC,KAAL;;AAEAD,QAAKF,IAAL,GAAY,UAASI,GAAT,EAAa;AACxBF,SAAKH,OAAL,CAAaC,IAAb,CAAkBI,GAAlB;AACA,QAAGF,KAAKJ,KAAR,EACCI,KAAKG,MAAL;AACD,IAJD;AAKA,GAba;AAcdF,SAAM,iBAAU;AACf,OAAID,OAAO,IAAX;AACAI,iBAAc,UAASC,IAAT,EAAc;AAC3BL,SAAKJ,KAAL,GAAaS,IAAb;AACAL,SAAKM,IAAL,GAAY,IAAZ;AACAN,SAAKG,MAAL;AACA,IAJD;AAKA,GArBa;AAsBdA,UAAO,kBAAU;AAChB,OAAIH,OAAO,IAAX;AACA,OAAID,EAAJ;AACA,UAAMA,KAAKC,KAAKH,OAAL,CAAaU,KAAb,EAAX,EAAgC;AAC/BR,OAAGC,KAAKJ,KAAR;AACA;AACD;AA5Ba,EAAf;;AA+BA,UAASQ,aAAT,CAAuBL,EAAvB,EAA0B;AACzBN,aAAWC,GAAG,6CAAH,CAAX,EAA8Dc,IAA9D,CAAmE,UAASC,QAAT,EAAkB;AAChF,OAAI;AACF,WAAOA,SAASC,IAAT,EAAP;AACD,IAFD,CAEE,OAAOC,CAAP,EAAU,CACX;AACF,GALJ,EAKMH,IALN,CAKW,UAASI,GAAT,EAAa;AACpB,OAAGA,IAAIC,IAAJ,IAAY,GAAf,EAAmB;AAClBd,OAAG;AACFe,aAAOF,IAAIP;AADT,KAAH;AAGA,IAJD,MAIK;AACJN,OAAG;AACFe,aAAO;AADL,KAAH;AAGA;AACD,GAfJ;AAgBA;;AAED,UAASC,OAAT,CAAiBC,IAAjB,EAAsBjB,EAAtB,EAAyB;AACxBiB,SAAOA,QAAQ,EAAf;AACA1B,WAAS,UAASsB,GAAT,EAAa;AACrB,OAAIxB,SAAS;AACZ6B,SAAIL,IAAIK,GADI;AAETC,SAAIN,IAAIM;AAFC,IAAb;AAIA,OAAGF,KAAKF,MAAR,EAAe;AACR1B,WAAO0B,MAAP,GAAgBE,KAAKF,MAArB;AACH,IAFJ,MAEQ;AACD1B,WAAO0B,MAAP,GAAgBF,IAAII,IAAJ,IAAUJ,IAAII,IAAJ,CAASG,MAAnB,IAA6B,EAA7C;AACH;AACDpB,MAAGX,MAAH;AACH,GAXD,EAWE,YAAU;AACX,OAAIgC,QAAQ,KAAZ;AACA,OAAGJ,KAAKK,IAAR,EAAa;AACZtB,OAAG;AACFe,aAAOE,KAAKF;AADV,KAAH;AAGA,IAJD,MAIK;AACJnB,aAASG,IAAT,CAAc,UAASO,IAAT,EAAc;AAC3B,MAACe,KAAD,IAAQrB,GAAGM,IAAH,CAAR;AACAe,aAAQ,IAAR;AACA,KAHD;AAIAE,eAAW,YAAU;AACpB,MAACF,KAAD,IAAQrB,GAAG;AACVe,cAAO;AADG,MAAH,CAAR;AAGAM,aAAQ,IAAR;AACA,KALD,EAKE,IALF;AAMA;AACD,GA7BD;AA8BA;AACDG,QAAOC,OAAP,GAAkB,UAASzB,EAAT,EAAY0B,GAAZ,EAAgBC,OAAhB,EAAwB;AAEzCD,QAAMA,OAAOjC,GAAGmC,MAAhB;;AAEA,MAAIvC,SAAS;AACZwC,YAAS,IADG;AAETZ,SAAK,IAFI;AAGTa,aAASJ,GAHA;AAITK,iBAAatC,GAAG6B,IAAH,IAAW,QAAX,GAAsB,IAAtB,GAA6B;AAJjC,GAAb;AAMAK,YAAUA,WAAW,EAArB;AACA,MAAGA,QAAQK,YAAX,EAAwB;AACvB3C,UAAO2C,YAAP,GAAsB,IAAtB;AACA;;AAGDzC,WAASF,MAAT,CAAgBA,MAAhB;;AAEA,MAAGI,GAAG6B,IAAH,IAAW,SAAd,EAAwB;AACvB9B,GAAA,oCAAmB,UAAUA,OAAV,EAAkB;AAC3B,QAAIyC,MAAM,mBAAAzC,CAAQ,EAAR,CAAV;AACAyC,QAAIC,KAAJ,CAAU,YAAY;AAErB,SAAIC,eAAe,KAAnB;AACA,SAAIC,gBAAgBb,WAAW,YAAU;AACxC,UAAG,CAACY,YAAJ,EAAiB;AAChBnB,eAAQ,EAAR,EAAWhB,EAAX;AACAmC,sBAAa,IAAb;AACA;AACD,MALmB,EAKlB,IALkB,CAApB;AAMGF,SAAII,OAAJ,CAAY;AACRC,eAAQ,iBAASrB,IAAT,EAAc;AACrB,WAAG,CAACkB,YAAJ,EAAiB;AAChB,YAAGlB,QAAQA,KAAKF,MAAL,IAAe,CAAC,CAA3B,EAA6B;AAC5BC,iBAAQ,EAAR,EAAWhB,EAAX;AACA,SAFD,MAEK;AACJgB,iBAAQC,IAAR,EAAajB,EAAb;AACA;AACD;;AAEDmC,sBAAa,IAAb;AACAI,oBAAaH,aAAb;AACA,OAZO;AAalBI,YAAK,cAASvB,IAAT,EAAc;AAClB,QAACkB,YAAD,IAAenB,QAAQC,IAAR,EAAajB,EAAb,CAAf;AACAmC,sBAAa,IAAb;AACAI,oBAAaH,aAAb;AACA;AAjBiB,MAAZ;AAmBH,KA5BD;AA6BH,IA/BP;AAgCA,GAjCD,MAiCM,IAAG3C,GAAG6B,IAAH,IAAW,OAAd,EAAsB;AAC3B9B,GAAA,mDAAmB,UAAUA,OAAV,EAAmB;AAC5B,QAAIiD,QAAQ,mBAAAjD,CAAQ,EAAR,CAAZ;AACAiD,UAAMP,KAAN,CAAY,YAAY;AACpBO,WAAMJ,OAAN,CAAc;AACVC,eAAS,iBAASrB,IAAT,EAAc;AAACD,eAAQC,IAAR,EAAajB,EAAb;AAAiB,OAD/B;AAEpBwC,YAAK,cAASvB,IAAT,EAAc;AAACD,eAAQC,IAAR,EAAajB,EAAb;AAAiB;AAFjB,MAAd;AAIH,KALD;AAMH,IARP;AASA,GAVK,MAUD;AACJgB,WAAQ,EAAR,EAAWhB,EAAX;AACA;AACD,EAhED,C;;;;;;ACzFA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wBAAuB;;AAEvB;AACA,sCAAqC,OAAO;AAC5C;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kD;;AAEA,wCAAuC,WAAW,E;AAClD;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA,wCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA,kBAAiB,E;AACjB;;AAEA,UAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;;;;;;AC1NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,G;;;;;;AC7BA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,oBAAmB;;AAEnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,gBAAe,E;AACf;AACA,YAAW;AACX;AACA;AACA,UAAS;AACT;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;AC/LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,4BAA2B;;AAE3B;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,6DAA4D;;AAE5D,wCAAuC,OAAO;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,8BAA6B,YAAY,cAAc;AACvD;AACA;AACA;AACA,yB;;;;;;ACtHA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,G;;;;;;ACtCA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA,G;;;;;;AC1EA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;;AAEA,6B;;;;;;ACzBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD,aAAa;AAChE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL;;AAEA;;;AAGA;;;;;;;AChDA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChBA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,eAAe,mBAAmB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC,kCAAiC;AACjC;AACA,8BAA6B;AAC7B,0BAAyB;AACzB;AACA;AACA,sBAAqB;AACrB;AACA,kBAAiB;;;AAGjB,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb,UAAS;AACT;AACA;AACA;AACA;;AAEA,gC;;;;;;;AC1DA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA,UAAS;AACT;;AAEA;;;AAGA,mC;;;;;;ACjCA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,0BAAyB;;AAEzB,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT;AACA;;AAEA,kC;;;;;;AClCA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA,kBAAiB;AACjB,cAAa;AACb,UAAS;AACT;;;AAGA;;AAEA,6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;;AAEA,iC;;;;;;AC9BA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA,8B;;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,UAAS;AACT;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,cAAa;AACb;AACA,cAAa;AACb;AACA;;AAEA,UAAS;AACT;;AAEA;AACA;;AAEA,UAAS;AACT;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA,UAAS;AACT;AACA;;AAEA,UAAS;AACT;AACA;;AAEA,UAAS;AACT;AACA;;AAEA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wB;;;;;;AC1JA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,2EAA0E;;AAE1E;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAO;AACP,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC,E;;;;;;AC3GD;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oCAAmC,GAAG;AACtC,sCAAqC,GAAG;AACxC,8BAA6B,GAAG;AAChC,uCAAsC,GAAG;AACzC,mCAAkC,GAAG;AACrC,qHAAoH,GAAG,UAAU,QAAQ,0CAA0C,GAAG,UAAU,QAAQ;AACxM,GAAE;AACF;AACA,+BAA8B,GAAG;AACjC,iCAAgC,GAAG;AACnC,6BAA4B,GAAG;AAC/B,sCAAqC,GAAG;AACxC,uCAAsC,GAAG,KAAK,GAAG;AACjD,qDAAoD,GAAG,WAAW,SAAS;AAC3E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,6CAA4C,UAAU;AACtD;;AAEA,iCAAgC,IAAI,IAAI;AACxC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO,QAAQ;AACf;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,G","file":"build.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tvar parentJsonpFunction = window[\"webpackJsonp\"];\n \twindow[\"webpackJsonp\"] = function webpackJsonpCallback(chunkIds, moreModules) {\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, callbacks = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId])\n \t\t\t\tcallbacks.push.apply(callbacks, installedChunks[chunkId]);\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules);\n \t\twhile(callbacks.length)\n \t\t\tcallbacks.shift().call(null, __webpack_require__);\n\n \t};\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// \"0\" means \"already loaded\"\n \t// Array means \"loading\", array contains callbacks\n \tvar installedChunks = {\n \t\t0:0\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId, callback) {\n \t\t// \"0\" is the signal for \"already loaded\"\n \t\tif(installedChunks[chunkId] === 0)\n \t\t\treturn callback.call(null, __webpack_require__);\n\n \t\t// an array means \"currently loading\".\n \t\tif(installedChunks[chunkId] !== undefined) {\n \t\t\tinstalledChunks[chunkId].push(callback);\n \t\t} else {\n \t\t\t// start chunk loading\n \t\t\tinstalledChunks[chunkId] = [callback];\n \t\t\tvar head = document.getElementsByTagName('head')[0];\n \t\t\tvar script = document.createElement('script');\n \t\t\tscript.type = 'text/javascript';\n \t\t\tscript.charset = 'utf-8';\n \t\t\tscript.async = true;\n\n \t\t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".build.js\";\n \t\t\thead.appendChild(script);\n \t\t}\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./test/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5dd5e97c5f19348215ae","import Geo from '../../index';\n\n\nGeo((config)=>{\n\talert(JSON.stringify(config));\n});\nGeo((config)=>{\n\talert(\"2:\"+JSON.stringify(config));\n});\n\n\n// WEBPACK FOOTER //\n// ./test/src/app.js","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/json/stringify.js\n// module id = 2\n// module chunks = 0","var core  = require('../../modules/_core')\n  , $JSON = core.JSON || (core.JSON = {stringify: JSON.stringify});\nmodule.exports = function stringify(it){ // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/json/stringify.js\n// module id = 3\n// module chunks = 0","var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_core.js\n// module id = 4\n// module chunks = 0","var Whereami = require(\"@dp/whereami\");\nvar ua = require(\"@dp/util-m-ua\")();\nvar fetchJsonp = require('fetch-jsonp');\nvar Ur = require(\"@dp/url-rewrite\");\n\n\nvar middleIp = {\n\tcache:false,\n\tcbQueue:[],\n\tpush:function(cb){\n\t\tvar self = this;\n\t\tself.cbQueue.push(cb);\n\t\tself.fetch();\n\t\t// 重载\n\t\tself.push = function(_cb){\n\t\t\tself.cbQueue.push(_cb);\n\t\t\tif(self.cache)\n\t\t\t\tself.action();\n\t\t}\n\t},\n\tfetch:function(){\n\t\tvar self = this;\n\t\tgetCityIdByIp(function(data){\n\t\t\tself.cache = data;\n\t\t\tself.lock = true;\n\t\t\tself.action();\n\t\t});\n\t},\n\taction:function(){\n\t\tvar self = this;\n\t\tvar cb;\n\t\twhile(cb = self.cbQueue.shift()){\n\t\t\tcb(self.cache);\n\t\t}\n\t}\n}\n\nfunction getCityIdByIp(cb){\n\tfetchJsonp(Ur(\"//promo.dianping.com/mtlist/getIpInfo.jsonp\")).then(function(response){\n      try {\n        return response.json();\n      } catch (e) {\t            \t\n      }\n    }).then(function(res){\n    \tif(res.code == 200){\n    \t\tcb({\n\t\t    \tcityId:res.data\n\t\t    });\n    \t}else{\n    \t\tcb({\n\t\t    \tcityId:\"\"\n\t\t    });\n    \t}\n    });\n}\n\nfunction _action(city,cb){\n\tcity = city || {};\n\tWhereami(function(res){\n\t\tvar config = {\n\t\t\tlng:res.lng,\n\t   \t\tlat:res.lat\n\t\t}\n\t\tif(city.cityId){\n\t        config.cityId = city.cityId;\n\t    }else{\n\t        config.cityId = res.city&&res.city.cityid || \"\";\n\t    }\n\t   \tcb(config);\n\t},function(){\n\t\tvar timer = false;\n\t\tif(city.type){\n\t\t\tcb({\n\t\t\t\tcityId:city.cityId\n\t\t\t});\n\t\t}else{\n\t\t\tmiddleIp.push(function(data){\n\t\t\t\t!timer&&cb(data);\n\t\t\t\ttimer = true;\n\t\t\t});\n\t\t\tsetTimeout(function(){\n\t\t\t\t!timer&&cb({\n\t\t\t\t\tcityId:\"\"\n\t\t\t\t});\n\t\t\t\ttimer = true;\n\t\t\t},2500);\n\t\t}\n\t});\n}\nmodule.exports =  function(cb,env,options){\n\t// env 兼容处理\n\tenv = env || ua.source;\n\n\tvar config = {\n\t\ttimeout: 3000,\n\t    city:true,\n\t    cityType:env,\n\t    wxAutoConfig:ua.type == \"weixin\" ? true : false\n\t}\n\toptions = options || {}\n\tif(options.useTecentGeo){\n\t\tconfig.useTecentGeo = true;\n\t}\n\n\t// 定位配置\n\tWhereami.config(config);\n\n\tif(ua.type == \"mtgroup\"){\n\t\trequire.ensure([], function (require){\n            var KNB = require(\"@dp/knb\");\n            KNB.ready(function () {\n            \t//再次给knb打补丁了\n            \tvar _lockGetCity = false;\n            \tvar _timerGetCity = setTimeout(function(){\n            \t\tif(!_lockGetCity){\n            \t\t\t_action({},cb);\n            \t\t\t_lockGetCity=true;\n            \t\t}\n            \t},2500);\n                KNB.getCity({\n                    success:function(city){\n                    \tif(!_lockGetCity){\n                    \t\tif(city && city.cityId == -1){\n\t                    \t\t_action({},cb);\n\t                    \t}else{\n\t                    \t\t_action(city,cb)\n\t                    \t}\n\t                    }\n\n                    \t_lockGetCity=true;\n                    \tclearTimeout(_timerGetCity);\n                    },\n\t      \t\t\tfail:function(city){\n\t      \t\t\t\t!_lockGetCity&&_action(city,cb);\n\t      \t\t\t\t_lockGetCity=true;\n\t      \t\t\t\tclearTimeout(_timerGetCity);\n\t      \t\t\t}\n                });\n            });\n        });\n\t}else if(ua.type == \"dpapp\"){\n\t\trequire.ensure([], function (require) {\n            var dpapp = require(\"@dp/dpapp\");\n            dpapp.ready(function () {\n                dpapp.getCity({\n                    success: function(city){_action(city,cb)},\n\t      \t\t\tfail:function(city){_action(city,cb)}\n                });\n            });\n        });\n\t}else{\n\t\t_action({},cb);\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./index.js","var config = require(\"./lib/config\");\nvar cache = require(\"./lib/geos/cache\");\nvar request = require(\"./lib/request\");\nvar log = require(\"./lib/log\");\n\nvar geos = [\n    require(\"./lib/geos/url\"),\n    cache,\n    require(\"./lib/geos/tecent\"),\n    require(\"./lib/geos/weixin\"),\n    require(\"./lib/geos/qqbrowser\"),\n    require(\"./lib/geos/mobileqq\"),\n    require(\"./lib/geos/app\"),\n    require(\"./lib/geos/meituanapp\"),\n    require(\"./lib/geos/html\")\n];\nvar isSpider = function () {\n    return !!navigator.userAgent.match(/spider/i);\n};\n\n//成功和失败的回掉队列\nvar sucCallbackQueue = [],\n    errorCallBackQueue = [];\n\nvar isLocating = false; //是否正在定位\n\nfunction execute(queue, args) {\n    for (var i = 0, l = queue.length; i < l; i++) {\n        queue.shift().apply(this, args || []);\n    }\n}\n\nvar urlDebug = ~location.href.indexOf(\"debug:whereami\");\n\n\nmodule.exports = function (onSuc, onFail) {\n    /**\n     * 过滤掉爬虫，直接onFail\n     * */\n\n    if (isSpider()) {\n        onFail();\n        return;\n    }\n\n    /**\n     * 回调统统丢到队列里面,防止调用多次,触发多次调用底层接口\n     * */\n\n    onSuc && sucCallbackQueue.push(onSuc);\n    onFail && errorCallBackQueue.push(onFail);\n\n    if (isLocating) {\n        return;\n    }\n\n    isLocating = true;\n    var isTimeout = false;\n    var timer;\n    var timeout = config.get(\"timeout\");\n    var disables = config.get(\"disables\");\n    var startTime = +new Date();\n    var geoMethodType;\n    var debug = urlDebug || config.get(\"debug\");\n\n    var getPositionSuccess = function (position) {\n        clearTimeout(timer);\n        isLocating = false;\n\n        if (position && position.lat && position.lng) {\n            log(startTime, geoMethodType, true);\n            //先设置cache , 即使是在主动超时的场景下\n            cache.set(position);\n        }\n\n        if (isTimeout) {\n            return;\n        }\n\n        if (!position || !position.lat || !position.lng || position.lat == \"0\" || position.lng == \"0\") {\n            return getPositionError();\n        }\n        if (debug) {\n            alert(JSON.stringify(position));\n        }\n\n        if (config.get(\"city\") && position && !position.city ) {\n            //调用接口获取City信息\n            if (config.get(\"cityType\") === 'meituan' || ~location.href.indexOf('.meituan.com')) {\n                var url\n                if (location.protocol === 'https:') {\n                    url = 'https://apimobile.meituan.com/group/v1/city/latlng/'\n                }else {\n                    url = 'http://api.mobile.meituan.com/group/v1/city/latlng/'\n                }\n                request({\n                    url: url+ position.lat+\",\"+position.lng,\n                    data: {\n                        tag: 0\n                    },\n                    onSuc: function(res) {\n                        if (res && res.data) {\n                            var data = res.data;\n                            var city = {\n                                cityid: data.id,\n                                cityname: data.city\n                            };\n                            position.city = city;   \n\n                            cache.set({city: city});                     \n                        }\n                        execute(sucCallbackQueue,[\n                            position\n                        ]);\n                    }\n                })\n            }else{\n                request({\n                    url: \"//m.dianping.com/getlocalcityid\",\n                    data: {\n                        lat: position.lat,\n                        lng: position.lng\n                    },\n                    onSuc: function (res) {\n                        if (res.code == 200 && res.message) {\n                            position.city = res.message;\n\n                            cache.set({city: position.city});\n                        }\n                        execute(sucCallbackQueue, [\n                            position\n                        ]);\n                    }\n                });                \n            }\n\n        } else {\n            execute(sucCallbackQueue, [\n                position\n            ]);\n        }\n\n\n    };\n    var getPositionError = function () {\n        clearTimeout(timer);\n        isLocating = false;\n        log(startTime, geoMethodType, false);\n        log.logError(geoMethodType, JSON.stringify(Array.prototype.slice.call(arguments, 0)));\n        if (isTimeout) {\n            return;\n        }\n        execute(errorCallBackQueue);\n//        if (e && e.code) {\n//            switch (e.code) {\n//                case 1:\n//                    //用户拒绝\n//                    break;\n//                case 2:\n//                case 3:\n//                    //定位失败\n//                    break;\n//            }\n//        }\n\n    };\n\n    if (timeout) {\n        timer = setTimeout(function () {\n            //超时\n            isTimeout = true;\n            isLocating = false;\n            execute(errorCallBackQueue);\n        }, timeout);\n    }\n\n    //依次call各个定位\n    var current = -1;\n    (function next() {\n        current++;\n        if (geos[current]) {\n            geoMethodType = geos[current].type;\n\n            if (disables && ~disables.indexOf(geoMethodType)) {\n                next();\n            } else {\n                if (debug) {\n                    alert(\"start geos:\" + geoMethodType);\n                }\n                geos[current](function (res) {\n                    res.type = geoMethodType;\n                    if (!res.geoType) {\n                        res.geoType = 'wgs84';\n                    }\n                    getPositionSuccess(res);\n                }, getPositionError, next);\n            }\n        } else {\n            //一个都没成功\n            getPositionError({\n                message: \"no geo support\"\n            });\n        }\n    })();\n\n};\n\nmodule.exports.config = config.config;\n\nmodule.exports.init = function () {\n    config.config({\n        wxAutoConfig: true\n    });\n    module.exports(function (res) {\n        console.log(res);\n    }, function () {\n        console.log(\"fail\")\n    })\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/index.js\n// module id = 6\n// module chunks = 0","var config = {\n//    bizName: \"default\",\n    timeout: 10000,\n    source: '',\n    enables: [],\n    disables: [],\n    urlParamNames: [\"latitude\", \"longitude\"],\n    cacheType: \"cookie\", //storage , false不缓存\n    cookieNames: [\"locallat\", \"locallng\", \"localcity\"],\n    storageName: \"whereami\",\n    wxAutoConfig: false,\n    useTecentGeo: false,\n    city:false,     //是否要获取City信息\n    debug: false\n};\n\n\nexports.get = function (key) {\n    return config[key];\n};\n\nexports.set = function (key, value) {\n    config[key] = value;\n};\n\nexports.config = function (obj) {\n    Object.keys(obj).forEach(function (key) {\n        config[key] = obj[key];\n    });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/config.js\n// module id = 7\n// module chunks = 0","//读取cookie中是否有缓存的定位信息\nvar cookie = require(\"../cookie\");\nvar config = require(\"../config\");\n\n\nvar cookieNames = config.get(\"cookieNames\");\nvar cacheType = config.get(\"cacheType\");\nvar storageKey = config.get(\"storageName\");\nvar disables = config.get(\"disables\");\nvar cLat = cookieNames[0];\nvar cLng = cookieNames[1];\nvar cCity = cookieNames[2];\nvar cType = 'geoType';\n\n\nvar cacheTime = 15; //分钟\n\n//  缓存在内存中\nvar positionMemory = {};\n\nvar supportLocalStorage = function() {\n  //iphone safari 无痕模式下设置localstorage时候会抛异常\n\n  var support = window.localStorage && window.localStorage != null;\n  var testKey = 'local_test';\n  if (support) {\n    try {\n      localStorage.setItem(testKey, 1);\n      localStorage.removeItem(testKey);\n    } catch (e) {\n      return false;\n    }\n  }\n  return support;\n};\n\nvar extend = function(target, source) {\n  for (var key in source) {\n    target[key] = source[key]\n  }\n  return target\n}\n\nmodule.exports = function(suc, fail, next) {\n\n  cacheType = config.get(\"cacheType\");\n  disables = config.get(\"disables\");\n\n  if (!cacheType) {\n    //不走缓存\n    next();\n  } else if (disables && disables.indexOf('cache') !== -1) {\n    next();\n  } else {\n    if (positionMemory && positionMemory.lat & positionMemory.lng) {\n      suc(positionMemory)\n    } else {\n      var positionCache;\n      //首先从storage中拿\n      if (!supportLocalStorage()) {\n        next()\n      } else {\n        storageKey = config.get(\"storageName\");\n\n        var cached = localStorage.getItem(storageKey);\n        if (cached) {\n          var jsonInfo = {};\n          try {\n            jsonInfo = JSON.parse(cached);\n            jsonInfo.city = JSON.parse(jsonInfo.city)\n          } catch (e) {\n            console.log('Parse position fail', e);\n          }\n          var t = jsonInfo.time;\n          var lat = +jsonInfo.lat;\n          var lng = +jsonInfo.lng;\n          var type = +jsonInfo.type;\n          var city = jsonInfo.city;\n\n          if (+new Date() - t > cacheTime * 60 * 1000 || !lat || !lng) {\n            localStorage.removeItem(storageKey);\n          } else {\n            positionCache = {\n              geoType: type,\n              lat: lat,\n              lng: lng,\n              city: city\n            }\n          }\n        }\n\n        if (cacheType == \"cookie\") {\n          cookieNames = config.get(\"cookieNames\");\n          cLat = cookieNames[0];\n          cLng = cookieNames[1];\n\n          var cookieLat = cookie(cLat);\n          var cookieLng = cookie(cLng);\n          var cookieType = cookie(cType);\n\n          if (cookieLat && cookieLng) {\n            if (positionCache && cookieLat == positionCache.lat && cookieLng == positionCache.lng) {\n              suc(positionCache)\n            }else{\n              suc({\n                geoType: cookieType,\n                lat: cookieLat,\n                lng: cookieLng\n              });              \n            }\n          } else {\n            next();\n          }\n        }else if (cacheType == \"storage\") {\n          if (positionCache && positionCache.lat && positionCache.lng) {\n            suc(positionCache)\n          }else{\n            next()\n          }\n        }else{\n          next()\n        }\n      }\n    }\n  }\n};\n\nmodule.exports.type = \"cache\";\n\nmodule.exports.set = function(position) {\n  position = position || {}\n\n  extend(positionMemory, position)\n\n  cacheType = config.get(\"cacheType\");\n  disables = config.get(\"disables\");\n\n  if (!cacheType) {\n    return;\n  }\n  //  如何数据来自缓存或禁止使用缓存\n  if (position.type === \"cache\" || (disables && disables.indexOf(\"cache\") !== -1)) {\n    return;\n  }\n\n  if (position.city) {\n    // 城市信息不走cookie\n    if (!supportLocalStorage()) {\n      return;\n    }\n    positionMemory.city = JSON.stringify(position.city)\n\n    storageKey = config.get(\"storageName\");\n    localStorage.setItem(storageKey, JSON.stringify(positionMemory));\n\n  } else if (position.lat && position.lng) {\n    if (cacheType == \"cookie\") {\n      var opt = {\n        expires: cacheTime / 60 / 24, // 15min\n        path: '/'\n      };\n      if (~location.hostname.indexOf(\"51ping.com\")) {\n        opt.domain = \".51ping.com\";\n      } else if (~location.hostname.indexOf(\"dianping.com\")) {\n        opt.domain = \".dianping.com\";\n      }\n\n      cookieNames = config.get(\"cookieNames\");\n      cLat = cookieNames[0];\n      cLng = cookieNames[1];\n      cCity = cookieNames[2];\n\n      if (position.lat && position.lng) {\n        cookie(cLat, position.lat, opt);\n        cookie(cLng, position.lng, opt);\n        cookie(cType, position.geoType, opt);\n      }\n\n    } else if (cacheType == \"storage\") {\n      if (!supportLocalStorage()) {\n        return;\n      }\n\n      positionMemory = position\n      positionMemory.time = +new Date()\n\n      storageKey = config.get(\"storageName\");\n      localStorage.setItem(storageKey, JSON.stringify(positionMemory));\n    }\n  }\n\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/cache.js\n// module id = 8\n// module chunks = 0","/*!\n * refer  jquery.cookie\n * https://github.com/carhartl/jquery-cookie\n *\n */\nvar isFunction = function(obj){\n    return Object.prototype.toString.call(obj) == '[object Function]';\n};\nvar extend = function(obj){\n    Array.prototype.slice.call(arguments, 1).forEach(function(source){\n        if (source) {\n            for (var prop in source) {\n                obj[prop] = source[prop];\n            }\n        }\n    });\n    return obj;\n};\n\n\nvar pluses = /\\+/g;\n\nfunction encode(s) {\n    return config.raw ? s : encodeURIComponent(s);\n}\n\nfunction decode(s) {\n    return config.raw ? s : decodeURIComponent(s);\n}\n\nfunction stringifyCookieValue(value) {\n    return encode(config.json ? JSON.stringify(value) : String(value));\n}\n\nfunction parseCookieValue(s) {\n    if (s.indexOf('\"') === 0) {\n        // This is a quoted cookie as according to RFC2068, unescape...\n        s = s.slice(1, -1).replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\');\n    }\n\n    try {\n        // Replace server-side written pluses with spaces.\n        // If we can't decode the cookie, ignore it, it's unusable.\n        // If we can't parse the cookie, ignore it, it's unusable.\n        s = decodeURIComponent(s.replace(pluses, ' '));\n        return config.json ? JSON.parse(s) : s;\n    } catch(e) {}\n}\n\nfunction read(s, converter) {\n    var value = config.raw ? s : parseCookieValue(s);\n    return isFunction(converter) ? converter(value) : value;\n}\n\nvar cookie,config,removeCookie;\n\nconfig = cookie = function (key, value, options) {\n\n    // Write\n\n    if (value !== undefined && !isFunction(value)) {\n        options = extend({}, config.defaults, options);\n\n        if (typeof options.expires === 'number') {\n            var days = options.expires, t = options.expires = new Date();\n            t.setTime(+t + days * 864e+5);\n        }\n\n        return (document.cookie = [\n                encode(key), '=', stringifyCookieValue(value),\n                options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\n                options.path    ? '; path=' + options.path : '',\n                options.domain  ? '; domain=' + options.domain : '',\n                options.secure  ? '; secure' : ''\n        ].join(''));\n    }\n\n    // Read\n\n    var result = key ? undefined : {};\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all. Also prevents odd result when\n    // calling $.cookie().\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n\n    for (var i = 0, l = cookies.length; i < l; i++) {\n        var parts = cookies[i].split('=');\n        var name = decode(parts.shift());\n        var cookie = parts.join('=');\n\n        if (key && key === name) {\n            // If second argument (value) is a function it's a converter...\n            result = read(cookie, value);\n            break;\n        }\n\n        // Prevent storing a cookie that we couldn't decode.\n        if (!key && (cookie = read(cookie)) !== undefined) {\n            result[name] = cookie;\n        }\n    }\n\n    return result;\n};\n\nconfig.defaults = {};\n\nremoveCookie = function (key, options) {\n    if (cookie(key) === undefined) {\n        return false;\n    }\n\n    // Must not alter options, thus extending a fresh object...\n    cookie(key, '', extend({}, options, { expires: -1 }));\n    return !cookie(key);\n};\ncookie.remove = removeCookie;\nmodule.exports = cookie;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/cookie.js\n// module id = 9\n// module chunks = 0","var globalCount = 0;\n\nvar urlStringify = function (url, data) {\n    if (!data) {\n        return url;\n    }\n    var param = [];\n    for (var o in data) {\n        if (data.hasOwnProperty(o)) {\n            param.push(o + \"=\" + data[o]);\n        }\n    }\n    return ~url.indexOf(\"?\") ? url +'&'+ param.join(\"&\") : url + \"?\" + param.join(\"&\");\n};\n\n/**\n * jsonp\n * */\nmodule.exports = function (options) {\n\n    if (!options.url) {\n        throw new Error(\"url request!\");\n    }\n    var data = options.data || {};\n    var cb = options.onSuc || function () {\n    };\n    var cbName = data.callback = \"WhereAmI\" + (++globalCount) + (+new Date());\n\n    var script = document.createElement(\"script\");\n    script.src = urlStringify(options.url, data);\n\n    window[cbName] = function (res) {\n        delete window[cbName];\n        script.parentNode.removeChild(script);\n        cb(res);\n    };\n\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/request.js\n// module id = 10\n// module chunks = 0","/**\n * log to cat\n * */\n\nvar request = require(\"./request\");\nvar config = require('./config');\n\nmodule.exports = function (startTime, type, isSuccess) {\n    var source = config.get('source');\n\n    var tuAll = \"whereami-type-all\";\n    var tuType = \"whereami-type-\" + type;\n    if (source) {\n        tuAll += ('-'+source);\n        tuType += ('-'+source);\n    }\n    /**\n     * cat 监控\n     * http://cat.dianpingoa.com/cat/r/web?domain=cat&ip=All&date=2015080314&reportType=view&op=view\n     * whereami开头的分类中\n     * */\n    var catData = {\n        v: 1,\n        ts: +new Date(),\n        tu: tuAll,\n        d: (+new Date() - startTime),\n        hs: isSuccess ? 200 : 500,\n        ec: \"\"\n    };\n\n    //发送all 和 指定type的\n    send(catData);\n\n    catData.tu = tuType;\n\n    send(catData);\n\n};\n\nvar send = function (catData) {\n    var catDataStr = [];\n    for (var o in catData) {\n        if (catData.hasOwnProperty(o)) {\n            catDataStr.push(o + \"=\" + catData[o]);\n        }\n    }\n    var img = new Image();\n    img.src = \"//catdot.dianping.com/broker-service/api/single?\" + catDataStr.join(\"&\");\n};\n\n/**\n * 手机详细错误日志，打到cat Event中\n * */\nmodule.exports.logError = function (geoType, info) {\n    var host = (~location.href.indexOf(\"51ping.com\") || ~location.href.indexOf(\"test.meituan.com\")) ? \"m.51ping.com\" : \"m.dianping.com\";\n    request({\n        url: \"//\" + host + \"/statictest/logevent\",\n        data: {\n            name: \"WhereAmIFail\",\n            info: encodeURIComponent(geoType + \"-\" + info)\n        }\n    });\n\n    //no support UA\n    if(~info.indexOf(\"no geo support\")){\n        request({\n            url: \"//\" + host + \"/statictest/logevent\",\n            data: {\n                name: \"WhereAmIFailUA\",\n                info: navigator.userAgent\n            }\n        });\n    }\n\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/log.js\n// module id = 11\n// module chunks = 0","var config = require(\"../config\");\n\nvar urlParamNames = config.get(\"urlParamNames\");\n\nvar pLat = urlParamNames[0];\nvar pLng = urlParamNames[1];\n\nvar latReg = new RegExp(pLat + \"=([^$&]+)\");\nvar lngReg = new RegExp(pLng + \"=([^$&]+)\");\n\nmodule.exports = function (suc, fail, next) {\n    var query = location.search;\n    var latMatch = query.match(latReg);\n    var lngMatch = query.match(lngReg);\n\n    if (latMatch && lngMatch && !isNaN(latMatch[1]) && !isNaN(lngMatch[1])) {\n        suc({\n            lat: latMatch[1],\n            lng: lngMatch[1]\n        });\n    } else {\n        next();\n    }\n};\n\nmodule.exports.type = \"url\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/url.js\n// module id = 12\n// module chunks = 0","//腾讯X5浏览器定位，适合在android 微信和手Q环境下使用\nvar util = require(\"../util\");\nvar config = require('../config');\n\nvar useTecentGeo = function() {\n  return ~config.get('enables').indexOf('x5');\n};\n\nmodule.exports = function(suc, fail, next) {\n  if (!useTecentGeo()) {\n    next();\n  } else {\n\n    var done = false;\n\n    var geoIframeId = '_geoIframe_' + Math.ceil(Math.random() * 10000000);\n    var geoIframe = document.createElement('iframe');\n    var key = '6ULBZ-4X3C3-QEK3S-3ZRI6-6D7RE-WQFRQ';\n    var referer = '大众点评M站';\n    var src = location.protocol + '//apis.map.qq.com/tools/geolocation?key=' + key + '&referer=' + referer + '_js';\n    if (config.get('debug')) {\n      src +' &debug=1';\n    }\n    geoIframe.setAttribute('id', geoIframeId);\n    geoIframe.setAttribute('src', src);\n    geoIframe.setAttribute('style', 'display: none; width: 100%; height: 30%');\n    document.body.appendChild(geoIframe);\n\n    window.addEventListener('message', function(event) {\n      // 接收位置信息\n      var position = event.data;\n      if (!done) {\n        if (position) {\n          suc({\n            geoType: 'gcj02',\n            lat: position.lat,\n            lng: position.lng\n          })\n        } else {\n          next();\n        }\n      }\n    }, false);\n  }\n\n};\n\n\nmodule.exports.type = \"x5\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/tecent.js\n// module id = 13\n// module chunks = 0","var cached = [];\n\n\nexports.loadScript = function (src, cb) {\n    if (~cached.indexOf(src)) {\n        cb();\n        return;\n    }\n\n    var script = document.createElement(\"script\");\n    script.src = src;\n    script.onload = function () {\n        cached.push(src);\n        cb();\n    };\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n};\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/util.js\n// module id = 14\n// module chunks = 0","//微信定位\nvar config = require(\"../config\");\nvar util = require(\"../util\");\nvar urlDebug = ~location.href.indexOf(\"debug:whereami\");\n\nvar isInWeixin = function () {\n    return /MicroMessenger/.test(navigator.userAgent);\n};\n\nmodule.exports = function (suc, fail, next) {\n    if (!isInWeixin()) {\n        next();\n    } else {\n        var wxGeo = function () {\n            if (typeof wx === \"undefined\") {\n                next();\n                return;\n            }\n            wx.ready(function () {\n                wx.checkJsApi({\n                    jsApiList: ['getLocation'], // 需要检测的JS接口列表，所有JS接口列表见附录2,\n                    success: function (res) {\n                        // 以键值对的形式返回，可用的api值true，不可用为false\n                        // 如：{\"checkResult\":{\"chooseImage\":true},\"errMsg\":\"checkJsApi:ok\"}\n                        if (res.checkResult && res.checkResult.getLocation) {\n                            wx.getLocation({\n                                type: 'wgs84', // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\n                                success: function (res) {\n                                    suc({\n                                        lat: res.latitude,\n                                        lng: res.longitude\n                                    });\n                                },\n                                fail: fail\n                            });\n                        } else {\n                            next();\n                        }\n                    },\n                    fail: next\n                });\n\n\n            });\n        };\n\n        if (config.get(\"wxAutoConfig\") && typeof wx === \"undefined\") {\n            require.ensure([], function (require) {\n                var loader = require(\"@dp/weixin-js-sdk-loader\");\n                loader.use(wxGeo);\n            });\n\n        } else {\n            wxGeo();\n        }\n    }\n};\n\nmodule.exports.type = \"weixin\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/weixin.js\n// module id = 15\n// module chunks = 0","//qq浏览器定位\nvar util = require(\"../util\");\n\nvar isInQQBrowser = function () {\n    return ~navigator.userAgent.indexOf(\"MQQBrowser\");\n};\n\nmodule.exports = function (suc, fail, next) {\n    if (!isInQQBrowser()) {\n        next();\n    } else {\n\n        util.loadScript(\"http://jsapi.qq.com/get?api=app.getGeoLocation\", function () {\n            try {\n                browser.app.getGeoLocation(function (res) {\n                    if (res.ret === \"true\") {\n                        suc({\n                            lat: res.latitude,\n                            lng: res.longitude\n                        });\n                    } else {\n                        fail.apply(this, Array.prototype.slice.call(arguments, 0));\n                    }\n                }, fail);\n            } catch (e) {\n                next();\n            }\n        });\n    }\n\n};\n\n\nmodule.exports.type = \"qqbrowser\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/qqbrowser.js\n// module id = 17\n// module chunks = 0","//手Q定位API\nvar util = require(\"../util\");\n\nvar isInMobileQQ = function () {\n    return navigator.userAgent.match(/(.*?(iPad|iPhone|iPod).*?QQ\\/([\\d\\.]+).*?)|(.*?\\bV1_AND_SQI?_([\\d\\.]+)(.*?QQ\\/([\\d\\.]+))?.*?)/i)\n};\n\n\nmodule.exports = function (suc, fail, next) {\n    if (!isInMobileQQ()) {\n        next();\n    } else {\n        util.loadScript(\"//open.mobile.qq.com/sdk/qqapi.js?_bid=152\", function () {\n            if (!window.mqq || !window.mqq.sensor || !window.mqq.sensor.getLocation) {\n                next();\n            } else {\n                mqq.sensor.getLocation({\n                    allowCacheTime: 60\n                }, function (retCode, latitude, longitude) {\n                    if (retCode == 0 && latitude && longitude) {\n                        suc({\n                            lat: latitude,\n                            lng: longitude\n                        });\n\n                    } else {\n                        fail.apply(this, Array.prototype.slice.call(arguments, 0));\n                    }\n                });\n            }\n        });\n    }\n};\n\nmodule.exports.type = \"mobileqq\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/mobileqq.js\n// module id = 18\n// module chunks = 0","//主app js bridge定位\nvar isInApp = function () {\n    return ~navigator.userAgent.indexOf(\"dianping\");\n};\n\n\nmodule.exports = function (suc, fail, next) {\n    if (!isInApp()) {\n        next();\n    } else {\n        require.ensure([], function (require) {\n            var dpapp = require(\"@dp/dpapp\");\n            dpapp.ready(function () {\n                dpapp.getLocation({\n                    success: function (e) {\n                        suc({\n                            lat: e.lat,\n                            lng: e.lng\n                        });\n                    },\n                    fail: fail\n                });\n            });\n        });\n    }\n\n\n};\n\nmodule.exports.type = \"app\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/app.js\n// module id = 19\n// module chunks = 0","/**\n * 美团App目前用URL参数来定位 , lat , lng\n * */\nvar latReg = new RegExp(\"lat=([^$&]+)\");\nvar lngReg = new RegExp(\"lng=([^$&]+)\");\n\nvar isInMeituan = function () {\n    //美团的ua不统一\n    return ~navigator.userAgent.indexOf(\"Meituan\");\n};\n\nmodule.exports = function (suc, fail, next) {\n    //if (!isInMeituan()) {\n    //    next()\n    //} else {\n        var query = location.search;\n        var latMatch = query.match(latReg);\n        var lngMatch = query.match(lngReg);\n\n        if (latMatch && lngMatch && !isNaN(latMatch[1]) && !isNaN(lngMatch[1])) {\n            suc({\n                lat: latMatch[1],\n                lng: lngMatch[1]\n            });\n        } else {\n            next();\n        }\n    //}\n};\n\nmodule.exports.type = \"meituan\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/meituanapp.js\n// module id = 63\n// module chunks = 0","//正常浏览器定位api\nvar config = require(\"../config\");\n\nvar supportGeo = function () {\n    return !!navigator.geolocation;\n};\n\n\nmodule.exports = function (suc, fail, next) {\n    if (!supportGeo()) {\n        next();\n    } else {\n        navigator.geolocation.getCurrentPosition(function (crd) {\n            suc({\n                lat: crd.coords.latitude,\n                lng: crd.coords.longitude\n            });\n        }, function (e) {\n            if (e) {\n                fail({\n                    code: e.code,\n                    message: e.message\n                });\n            }else{\n                fail({\n                    message:\"unknown error\"\n                });\n            }\n        }, {\n            enableHighAccuracy: true,\n            maximumAge: 30000,\n            timeout: config.get(\"timeout\") || 100000\n        });\n    }\n};\n\nmodule.exports.type = \"html\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/whereami/lib/geos/html.js\n// module id = 64\n// module chunks = 0","var getUA = function(ua, url) {\n    var UA = ua || navigator.userAgent || navigator.vendor || window.opera;\n    var URL = url || location.href;\n    var result = {};\n    var type;\n    var version;\n    var os;\n    var osVersion;\n    var kernal;\n    var source;\n    var env\n\n    function match(reg) {\n        if (reg) {\n            if (UA.match(reg) && UA.match(reg).length) {\n                return UA.match(reg)[1];\n            }\n        }\n    }\n\n    function matchTypeVersion(reg) {\n        if (reg) {\n            if (UA.match(reg) && UA.match(reg).length >= 2) {\n                return UA.match(reg);\n            } else {\n                return ['', '0.0.0'];\n            }\n        }\n    }\n\n    function isMobile() {\n        var check = false;\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(UA) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(UA.substr(0, 4))) check = true \n        return check;\n    }\n    \n\n    try {\n        //mobile detect\n        result.isMobile = isMobile();\n\n        //os detect\n        if (UA.match(/android/i)) {\n            result.os = 'android';\n\n            result.osVersion = match(/Android\\/([\\d\\.]+)/i) || match(/Android ([\\d\\.]+)/);\n\n            result.kernal = match(/AppleWebKit\\/([\\d\\.]+)/i);\n\n            result.browserVersion = match(/Chrome\\/([\\d\\.]+)/i);\n        } else if (UA.match(/(ipad|iphone|ipod).*os\\s([\\d_]+)/i)) {\n            result.os = 'ios';\n\n            result.osVersion = match(/iOS\\/([\\d\\.]+)/) || match(/OS ([\\d\\_]+)/).split('_').join('.');\n\n            result.kernal = match(/AppleWebKit\\/([\\d\\.]+)/i);\n\n            result.browserVersion = match(/Safari\\/([\\d\\.]+)/i);\n        }\n\n        //environment & version detect\n        if (/dp\\/com\\.dianping/.test(UA)) {\n            var arr = matchTypeVersion(/dp\\/com\\.dianping\\.([\\w\\.]+)\\/([\\d\\.]+)/);\n            var typeKey = arr[1];\n            version = arr[2];\n            if (typeKey.indexOf('dpscope') !== -1) {\n                type = 'dpapp';\n            } else if (typeKey.indexOf('v1') !== -1) {\n                type = 'dpapp'\n                if (/adapter\\/([\\d\\.]+)/.test(UA)) {\n                    version = match(/adapter\\/([\\d\\.]+)/);\n                }\n            } else if (typeKey.indexOf('merchant')) {\n                type = 'dpmerchant';\n            } else if (typeKey.indexOf('wed')) {\n                type = 'dpwed';\n            } else {\n                type = 'dp';\n            }\n\n        } else if (/MeituanGroup/i.test(UA)) {\n            type = 'mtgroup';\n\n            var arr = matchTypeVersion(/(MeituanGroup)\\/([\\d\\.]+)/i);\n            version = arr[2];\n\n        } else if (/(f=android)|(f=iphone)|(f=ipad)|(f=ios)/g.test(URL)) {\n            if (/(utm_campaign=Agroup)/.test(URL)) {\n                type = 'mtgroup';\n            } else {\n                type = 'mt'\n            }\n            var param = {};\n            try {\n                var query = URL.split('?')[1].split('&');\n                if (query && query.length) {\n                    query.map(function(str) {\n                        var arr = str.split('=');\n                        param[arr[0]] = arr[1];\n                    })\n                }\n            } catch (e) {\n                console.log('parse param failed');\n            }\n            version = param.version_name;\n        } else if (/MicroMessenger/.test(UA)) {\n            type = 'weixin';\n            version = match(/MicroMessenger\\/([\\d\\.]+)/i);\n\n        } else if (/QZONE/.test(UA)) {\n            type = 'qqzone';\n            version = match(/QZONEJSSDK\\/([\\d\\.]+)/);\n\n        } else if (/QQ\\/([\\d\\.]+)/.test(UA)) {\n            type = 'qq';\n            version = match(/QQ\\/([\\d\\.]+)/i);\n\n        } else if (/UCWEB/i.test(UA)) {\n            type = 'ucweb';\n            version = match(/UCWEB([\\d\\.]+)/i);\n\n        } else {\n            type = 'browser';\n        }\n\n        //区分业务：点评OR美团\n        if (/\\.dianping\\.com/i.test(URL)) {\n            source = 'dianping';\n            env = 'product';\n        }else if (/\\.51ping\\.com/i.test(URL)) {\n            source = 'dianping';\n            env = 'beta';\n        }else if (/test\\.([\\w\\.]+)meituan\\.com/i.test(URL)) {\n            source = 'meituan';\n            env = 'beta';\n        }else if (/\\.meituan\\.com/i.test(URL)) {\n            source = 'meituan';\n            env = 'product';\n        }\n\n        result.type = type;\n        result.version = version;\n        result.source = source;\n        result.env = env;\n\n        return result;\n    } catch (e) {\n        console.log(e);\n        result.type = type;\n        result.version = version;\n\n        return result;\n    }\n};\nmodule.exports = getUA;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/util-m-ua/index.js\n// module id = 65\n// module chunks = 0","(function (global, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['exports', 'module'], factory);\n  } else if (typeof exports !== 'undefined' && typeof module !== 'undefined') {\n    factory(exports, module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports, mod);\n    global.fetchJsonp = mod.exports;\n  }\n})(this, function (exports, module) {\n  'use strict';\n\n  var defaultOptions = {\n    timeout: 5000,\n    jsonpCallback: 'callback',\n    jsonpCallbackFunction: null\n  };\n\n  function generateCallbackFunction() {\n    return 'jsonp_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n  }\n\n  // Known issue: Will throw 'Uncaught ReferenceError: callback_*** is not defined'\n  // error if request timeout\n  function clearFunction(functionName) {\n    // IE8 throws an exception when you try to delete a property on window\n    // http://stackoverflow.com/a/1824228/751089\n    try {\n      delete window[functionName];\n    } catch (e) {\n      window[functionName] = undefined;\n    }\n  }\n\n  function removeScript(scriptId) {\n    var script = document.getElementById(scriptId);\n    document.getElementsByTagName('head')[0].removeChild(script);\n  }\n\n  function fetchJsonp(_url) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    // to avoid param reassign\n    var url = _url;\n    var timeout = options.timeout || defaultOptions.timeout;\n    var jsonpCallback = options.jsonpCallback || defaultOptions.jsonpCallback;\n\n    var timeoutId = undefined;\n\n    return new Promise(function (resolve, reject) {\n      var callbackFunction = options.jsonpCallbackFunction || generateCallbackFunction();\n      var scriptId = jsonpCallback + '_' + callbackFunction;\n\n      window[callbackFunction] = function (response) {\n        resolve({\n          ok: true,\n          // keep consistent with fetch API\n          json: function json() {\n            return Promise.resolve(response);\n          }\n        });\n\n        if (timeoutId) clearTimeout(timeoutId);\n\n        removeScript(scriptId);\n\n        clearFunction(callbackFunction);\n      };\n\n      // Check if the user set their own params, and if not add a ? to start a list of params\n      url += url.indexOf('?') === -1 ? '?' : '&';\n\n      var jsonpScript = document.createElement('script');\n      jsonpScript.setAttribute('src', '' + url + jsonpCallback + '=' + callbackFunction);\n      jsonpScript.id = scriptId;\n      document.getElementsByTagName('head')[0].appendChild(jsonpScript);\n\n      timeoutId = setTimeout(function () {\n        reject(new Error('JSONP request to ' + url + ' timed out'));\n\n        clearFunction(callbackFunction);\n        removeScript(scriptId);\n      }, timeout);\n    });\n  }\n\n  // export as global function\n  /*\n  let local;\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n  local.fetchJsonp = fetchJsonp;\n  */\n\n  module.exports = fetchJsonp;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/fetch-jsonp/build/fetch-jsonp.js\n// module id = 66\n// module chunks = 0","\"use strict\";\n\nvar _utilMUa = require(\"@dp/util-m-ua\");\n\nvar _utilMUa2 = _interopRequireDefault(_utilMUa);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ua = (0, _utilMUa2.default)();\n\nvar AJAX_ENUM = [{\n\tdp: \"//promo.dianping.com/list\",\n\tdptest: \"//promo.51ping.com/list\"\n}, {\n\tdp: \"//promo.dianping.com/mtlist\",\n\tdptest: \"//promo.51ping.com/mtlist\",\n\tmt: \"//i.meituan.com/mtlist\",\n\tmttest: \"//test.i.meituan.com/mtlist\"\n}, {\n\tdp: \"//promo.dianping.com/services\",\n\tdptest: \"//promo.51ping.com/services\",\n\tmt: \"//i.meituan.com/services\",\n\tmttest: \"//test.i.meituan.com/services\"\n}];\n\nvar Ur = module.exports = function (url) {\n\treturn _webUr(url, AJAX_ENUM);\n};\n\nfunction _webUr(url, enum_arrs) {\n\tvar result = void 0;\n\n\tenum_arrs.some(function (it) {\n\t\tfor (var key in it) {\n\t\t\tvar value = it[key];\n\t\t\tif (~url.indexOf(value)) {\n\t\t\t\tvar path = url.replace(new RegExp(\"[^/]*?\" + value), \"\");\n\n\t\t\t\tvar prefix = ua.source == \"meituan\" ? ~location.host.indexOf(\"test\") ? it[\"mttest\"] : it[\"mt\"] : ua.source == \"dianping\" ? ~location.host.indexOf(\"51ping\") ? it[\"dptest\"] : it[\"dp\"] : it[\"dptest\"];\n\t\t\t\tif (prefix) {\n\t\t\t\t\tresult = prefix + path;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t});\n\n\tif (!result) console.log(url + \"不存在隐射域名中\");\n\n\treturn result || url;\n}\n\nfunction _appUr(obj) {\n\treturn ua.type == \"dpapp\" ? obj[\"dpapp\"] : ua.type == \"mtgroup\" ? obj[\"mtgroup\"] : false;\n}\n\nvar SKIP_ENUM = {\n\tdeal: {\n\t\tdp: \"//m.dianping.com/tuan/deal/{id}\",\n\t\tdptest: \"//m.51ping.com/tuan/deal/{id}\",\n\t\tmt: \"//i.meituan.com/deal/{id}.html\",\n\t\tmttest: \"//test.i.meituan.com/deal/{id}.html\",\n\t\tdpapp: \"dianping://tuandeal?id={id}\",\n\t\tmtgroup: parseInt((ua.version || \"\").replace(/\\./g, \"\")) >= 730 ? \"imeituan://www.meituan.com/gc/deal/detail?did={id}&channel={channel}\" : \"imeituan://www.meituan.com/deal?did={id}&channel={channel}\"\n\t},\n\tshop: {\n\t\tdp: \"//m.dianping.com/shop/{id}\",\n\t\tdptest: \"//m.51ping.com/shop/{id}\",\n\t\tmt: \"//i.meituan.com/poi/{id}\",\n\t\tmttest: \"//test.i.meituan.com/poi/{id}\",\n\t\tdpapp: \"dianping://shopinfo?shopid={id}&id={id}\",\n\t\tmtgroup: \"imeituan://www.meituan.com/merchant?id={id}&showtype={showtype}\"\n\t}\n};\n\nfunction _handler(value) {\n\treturn function (opt) {\n\t\tvar matchStr = _appUr(value) || _webUr(value[\"dp\"], [value]) || false;\n\n\t\tfor (var k in opt) {\n\t\t\tvar v = opt[k];\n\t\t\tmatchStr = matchStr.replace(new RegExp(\"{\" + k + \"}\", \"g\"), v);\n\t\t}\n\n\t\treturn matchStr.replace(/\\&?\\{[^\\}]+\\}/g, \"\");;\n\t};\n}\n\nfor (var key in SKIP_ENUM) {\n\tvar value = SKIP_ENUM[key];\n\tUr[key] = _handler(value);\n}\n\nUr.methodExtend = function (key, value) {\n\tif (!Ur[key]) {\n\t\tUr[key] = _handler(value);\n\t} else {\n\t\tconsole.log(key + \"方法已存在\");\n\t}\n};\n\nUr.AjaxExtend = function (value) {\n\tAJAX_ENUM.push(value);\n};\n\nfunction normalize_array(parts) {\n\tvar up = 0;\n\tvar i = parts.length - 1;\n\tfor (; i >= 0; i--) {\n\t\tvar last = parts[i];\n\t\tif (last === '.') {\n\t\t\tparts.splice(i, 1);\n\t\t} else if (last === '..') {\n\t\t\tparts.splice(i, 1);\n\t\t\tup++;\n\t\t} else if (up) {\n\t\t\tparts.splice(i, 1);\n\t\t\tup--;\n\t\t}\n\t}\n\n\twhile (up--) {\n\t\tparts.unshift('..');\n\t}\n\n\treturn parts;\n}\n\nUr.resolve = function (from, to) {\n\tvar parts = (from + '/' + to).split('/').filter(Boolean);\n\treturn normalize_array(parts).join('/');\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/@dp/url-rewrite/dist/index.js\n// module id = 67\n// module chunks = 0"],"sourceRoot":""}