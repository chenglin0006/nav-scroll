{"version":3,"sources":["webpack:///webpack/bootstrap 2304d78c3c719e6116be","webpack:///./test/src/app.js","webpack:///./src/index.js","webpack:///./~/@dp/util-m-ua/index.js"],"names":[],"mappings":"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","file":"build.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./test/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2304d78c3c719e6116be\n **/","import test from '../../src/index'\n\n\ntest(\"//promo.dianping.com/services/drawlist.jsonp\");\n\ntest.deal({id:434})\ntest.shop({id:434})\n\n\n/** WEBPACK FOOTER **\n ** ./test/src/app.js\n **/","import UA  from \"@dp/util-m-ua\"\nlet ua = UA();\n\n/**\n * [KEY_ENUM description]\n * ajax访问地址映射,可扩展\n * @type {Array}\n */\nlet AJAX_ENUM = [\n\t//营销平台 \n\t{\n\t\tdp:\"//promo.dianping.com\",\n\t\tdptest:\"//promo.51ping.com\",\n\t\tmt:\"//i.meituan.com\",\n\t\tmttest:\"//test.i.meituan.com\"\n\t}\n]\n\n\nlet Ur = module.exports  = function(url){\n\treturn _webUr(url,AJAX_ENUM);\n};\n\n\n/**\n * [_webUr 转化web 路径]\n * @param  {[type]} url  [description]\n * @param  {[type]} enum [description]\n * @return {[type]}      [description]\n */\nfunction _webUr(url,enum_arrs){\n\tlet result;\n\n\tenum_arrs.some((it)=>{\n\t\tfor(let key in it){\n\t\t\tlet value = it[key];\n\t\t\tif(~url.indexOf(value)){\n\t\t\t\tlet path = url.replace(new RegExp(`[^\\/]*?${value}`),\"\");\n\n\t\t\t\tlet prefix =  ua.source == \"meituan\" ? (\n\t\t\t\t\t\t~location.host.indexOf(\"test\") ? it[\"mttest\"] : it[\"mt\"]\n\t\t\t\t\t)\n\t\t\t\t\t:\n\t\t\t\t\t(\n\t\t\t\t\t\tua.source == \"dianping\" ?  (\n\t\t\t\t\t\t\t~location.host.indexOf(\"51ping\") ? it[\"dptest\"] : it[\"dp\"]\n\t\t\t\t\t\t)\n\t\t\t\t\t\t:\n\t\t\t\t\t\tit[\"dptest\"]\n\t\t\t\t\t);\n\t\t\t\tif(prefix){\n\t\t\t\t\tresult = prefix + path;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t});\n\n\tif(!result)\n\t\tconsole.log(`${url}不存在隐射域名中`)\n\n\treturn result || url;\n}\n\n/**\n * [返回app跳转链接]\n * @param  {[type]} obj [description]\n * @return {[type]}     [description]\n */\nfunction _appUr(obj){\n\treturn ua.type == \"dpapp\" ? obj[\"dpapp\"]\n\t\t\t: ua.type == \"mtgroup\" ? obj[\"dpapp\"] : false\n}\n\n/**\n * [SKIP_ENUM 跳转链接隐射]\n * 扩展\n * @type {Object}\n */\nlet SKIP_ENUM = {\n\tdeal:{\n\t\tdp:\"//m.dianping.com/tuan/deal/{id}\",\n\t\tdptest:\"//m.51ping.com/tuan/deal/{id}\",\n\t\tmt:\"//i.meituan.com/deal/${id}.html\",\n\t\tmttest:\"//test.i.meituan.com/deal/{id}.html\",\n\t\tdpapp:\"dianping://tuandeal?id={id}\",\n\t\tmtgroup:\"imeituan://www.meituan.com/deal?did={id}\"\n\t},\n\tshop:{\n\t\tdp:\"//m.dianping.com/shop/{id}\",\n\t\tdptest:\"//m.51ping.com/shop/{id}\",\n\t\tmt:\"//i.meituan.com/poi/{id}\",\n\t\tmttest:\"//test.i.meituan.com/poi/{id}\",\n\t\tdpapp:\"dianping://shopinfo?shopid={id}&id={id}\",\n\t\tmtgroup:\"imeituan://www.meituan.com/merchant?id={id}\"\n\t}\n}\n/**\n * 扩展跳转暴漏接口\n * @param  {[type]} it){\tUr} [description]\n * @return {[type]}            [description]\n */\nfor(let key in SKIP_ENUM){\n\tlet value = SKIP_ENUM[key];\n\n\tUr[key] = function(opt){\n\t\t/**\n\t\t * 看是否在app内\n\t\t * 看web转换,试以dp参数传入\n\t\t * @type {[type]}\n\t\t */\n\t\tlet matchStr = _appUr(value) || _webUr(value[\"dp\"],[value]) || false;\n\n\t\tfor(let k in opt){\n\t\t\tlet v = opt[k];\n\t\t\tmatchStr = matchStr.replace(new RegExp(`\\{${k}\\}`,\"g\") ,v);\t\t\n\t\t}\n\n\t\treturn  matchStr;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","var getUA = function(ua, url) {\n    var UA = ua || navigator.userAgent || navigator.vendor || window.opera;\n    var URL = url || location.href;\n    var result = {};\n    var type;\n    var version;\n    var os;\n    var osVersion;\n    var kernal;\n    var source;\n    var env\n\n    function match(reg) {\n        if (reg) {\n            if (UA.match(reg) && UA.match(reg).length) {\n                return UA.match(reg)[1];\n            }\n        }\n    }\n\n    function matchTypeVersion(reg) {\n        if (reg) {\n            if (UA.match(reg) && UA.match(reg).length >= 2) {\n                return UA.match(reg);\n            } else {\n                return ['', '0.0.0'];\n            }\n        }\n    }\n\n    function isMobile() {\n        var check = false;\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(UA) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(UA.substr(0, 4))) check = true \n        return check;\n    }\n    \n\n    try {\n        //mobile detect\n        result.isMobile = isMobile();\n\n        //os detect\n        if (UA.match(/android/i)) {\n            result.os = 'android';\n\n            result.osVersion = match(/Android\\/([\\d\\.]+)/i) || match(/Android ([\\d\\.]+)/);\n\n            result.kernal = match(/AppleWebKit\\/([\\d\\.]+)/i);\n\n            result.browserVersion = match(/Chrome\\/([\\d\\.]+)/i);\n        } else if (UA.match(/(ipad|iphone|ipod).*os\\s([\\d_]+)/i)) {\n            result.os = 'ios';\n\n            result.osVersion = match(/iOS\\/([\\d\\.]+)/) || match(/OS ([\\d\\_]+)/).split('_').join('.');\n\n            result.kernal = match(/AppleWebKit\\/([\\d\\.]+)/i);\n\n            result.browserVersion = match(/Safari\\/([\\d\\.]+)/i);\n        }\n\n        //environment & version detect\n        if (/dp\\/com\\.dianping/.test(UA)) {\n            var arr = matchTypeVersion(/dp\\/com\\.dianping\\.([\\w\\.]+)\\/([\\d\\.]+)/);\n            var typeKey = arr[1];\n            version = arr[2];\n            if (typeKey.indexOf('dpscope') !== -1) {\n                type = 'dpapp';\n            } else if (typeKey.indexOf('v1') !== -1) {\n                type = 'dpapp'\n                if (/adapter\\/([\\d\\.]+)/.test(UA)) {\n                    version = match(/adapter\\/([\\d\\.]+)/);\n                }\n            } else if (typeKey.indexOf('merchant')) {\n                type = 'dpmerchant';\n            } else if (typeKey.indexOf('wed')) {\n                type = 'dpwed';\n            } else {\n                type = 'dp';\n            }\n\n        } else if (/MeituanGroup/i.test(UA)) {\n            type = 'mtgroup';\n\n            var arr = matchTypeVersion(/(MeituanGroup)\\/([\\d\\.]+)/i);\n            version = arr[2];\n\n        } else if (/(f=android)|(f=iphone)|(f=ipad)|(f=ios)/g.test(URL)) {\n            if (/(utm_campaign=Agroup)/.test(URL)) {\n                type = 'mtgroup';\n            } else {\n                type = 'mt'\n            }\n            var param = {};\n            try {\n                var query = URL.split('?')[1].split('&');\n                if (query && query.length) {\n                    query.map(function(str) {\n                        var arr = str.split('=');\n                        param[arr[0]] = arr[1];\n                    })\n                }\n            } catch (e) {\n                console.log('parse param failed');\n            }\n            version = param.version_name;\n        } else if (/MicroMessenger/.test(UA)) {\n            type = 'weixin';\n            version = match(/MicroMessenger\\/([\\d\\.]+)/i);\n\n        } else if (/QZONE/.test(UA)) {\n            type = 'qqzone';\n            version = match(/QZONEJSSDK\\/([\\d\\.]+)/);\n\n        } else if (/QQ\\/([\\d\\.]+)/.test(UA)) {\n            type = 'qq';\n            version = match(/QQ\\/([\\d\\.]+)/i);\n\n        } else if (/UCWEB/i.test(UA)) {\n            type = 'ucweb';\n            version = match(/UCWEB([\\d\\.]+)/i);\n\n        } else {\n            type = 'browser';\n        }\n\n        //区分业务：点评OR美团\n        if (/\\.dianping\\.com/i.test(URL)) {\n            source = 'dianping';\n            env = 'product';\n        }else if (/\\.51ping\\.com/i.test(URL)) {\n            source = 'dianping';\n            env = 'beta';\n        }else if (/test\\.([\\w\\.]+)meituan\\.com/i.test(URL)) {\n            source = 'meituan';\n            env = 'beta';\n        }else if (/\\.meituan\\.com/i.test(URL)) {\n            source = 'meituan';\n            env = 'product';\n        }\n\n        result.type = type;\n        result.version = version;\n        result.source = source;\n        result.env = env;\n\n        return result;\n    } catch (e) {\n        console.log(e);\n        result.type = type;\n        result.version = version;\n\n        return result;\n    }\n};\nmodule.exports = getUA;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/@dp/util-m-ua/index.js\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}