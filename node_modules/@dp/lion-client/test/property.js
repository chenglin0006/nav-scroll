var assert = require("assert");
var property = require("../lib/property");

const UNKNOWN = "UnKnownKey";
const DEFAULT_VALUE = "defaultValue";

describe("property", function () {

    describe("#getProperty", function () {
        it("should return a Promise", function () {
            assert(property.getProperty("someKey") instanceof Promise);
        });

        it("should resolve defaultValue when getting unknown key with a defaultValue", function (done) {

            property.getProperty(UNKNOWN, DEFAULT_VALUE).then(function (value) {
                assert.equal(value, DEFAULT_VALUE);
                done();
            });
        });

        it("should resolve Null when getting unknown key without a defaultValue", function (done) {

            property.getProperty(UNKNOWN).then(function (value) {
                assert.equal(value, null);
                done();
            });

        });

        it("resolve nested key config", function (done) {
            property.getProperty('dp-common-service.common.master.jdbc.url').then(function (value) {
                assert(value.indexOf("${") == -1);
                console.log(value);
                done();
            });
        });
    });

});