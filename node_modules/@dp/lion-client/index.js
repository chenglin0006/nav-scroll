var zk = require("./lib/zk");
var property = require("./lib/property");
var httpProperty = require("./lib/http_property");

/**
 *
 * Lion 单例模式， 确保在不同模块中不会多次初始化， 配置的值也会共享
 *
 * */

var globalLionInstance = global.LION_INSTANCE;

if (!globalLionInstance) {
    globalLionInstance = global.LION_INSTANCE = module.exports = {
        /**
         * Lion 初始化， getProperty 已经自动处理了初始化，可以不显示调用
         * 推荐Web应用在启动的时候调用一次
         * @return Promise
         * */
        init: zk.init,
        /**
         * 获取配置值
         * @return Promise
         * */
        getProperty: property.getProperty,

        /**
         * http方式获取配置, 非Web应用可用此方式
         * @return Promise
         * */
        httpGetProperty: httpProperty.getProperty,

        addListener: property.addListener
    }
} else {
    module.exports = globalLionInstance;
}